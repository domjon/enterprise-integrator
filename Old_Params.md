# Старые требования до версии 1.09 #
1С:Предприятие (8.0.12.21-8.1.11) в серверном варианте работы  (возможно использовать и файловом режиме с некоторыми ограничениями)
Сервер баз данных MS SQL2000 - MS SQL2005 (8.xxx - 9.xxx)
Сервер MSSQL должен быть сконфигурирован следующим образом (**параметры выделенные жирным объязательны)**

|Name (sp\_configure)| Config\_Value  8.xxx / 9.xxx | Run\_Value  8.xxx / 9.xxx|
|:-------------------|:-----------------------------|:-------------------------|

|Ole Automation Procedures |- / 1 |- / 1|
|:-------------------------|:-----|:----|
|Lightweight pooling       |0 / - | 0 / -|
| **Xp\_cmdshell**         | - / 1|- / 1|
|allow updates             | - / -|1 /- |

```
If (Select Convert(int,CONVERT(Char(1),SERVERPROPERTY('ProductVersion'))))>8
Begin Exec 
sp_configure 'show advanced options', 1;
RECONFIGURE;
Exec sp_configure 'Ole Automation Procedures', 1;
Exec sp_configure 'xp_cmdshell',1;
Exec sp_configure 'allow updates',1;
RECONFIGURE;
End
Else
Begin 
Exec sp_configure 'show advanced options', 1;
RECONFIGURE;
Exec sp_configure 'lightweight pooling', 0;
RECONFIGURE;
End
```
# Разрешения #
Пользователь MS SQL должен иметь следующие разрешения:
  1. ALTER TRACE
  1. ALTER TABLE для таблиц **Enum_1. CONTROL SERVER
  1. CREATE VIEW
  1. DROP VIEW
# Используемые ресурсы #_|**Имя| **Ресурс** | **Цель** |
|:---------------------------------------------------------------------------------------|:-----------|:---------|
|ADODB.Connection                                                                        | Создание подключения к источнику данных и эквивалентен текущему сетевому соединению с сервером. Выполнение запросов| |
|ADODB.Recordset                                                                         | Изменение данных в БД| |
|ADODB.Stream                                                                            |Сохранение служебных двочичных данных 1с:Предприятия в файл на рабочей станции, перемещение файлов трассировки с сервера на рабочую станцию| |

|V8.COMConnector|  Получаение параметров текущей ИБ на сервере, подключение к Текущей ИБ ("Выполнять/трассировать  запросы используя COM соединение")| |
|:--------------|:-----------------------------------------------------------------------------------------------------------------------------------|:|
|Excel.Application|  Выгрузка рузультатов в MS Excel                                                                                                   | |
|WScript.Shell  |  Для изменений значений реестра, снижения безопасности Excel (создание группировок)                                                | |
|cmd            | cmd.exe                                                                                                                            | Выполнения команды findstr (при обработке служебных файлов), move(для перемещений каталогов) и tasklist (для определения запущеных задач).|
|[v8Unpack\*](http://infostart.ru/profile/16971/projects/1843/)| v8.exe  автор Демидов Денис aka disa\_da                                                                                           | Распаковка, упаковка  служебных данные 1с: Предприятия алгоритмом Deflate.|
|[BinFiles\*](http://1c.proclub.ru/modules/mydownloads/personal.php?cid=5&lid=3794)| BinFiles.dll автор Барышников С. А.                                                                                                | Внешная компонента 1с. Предназначена для побайтного чтения файлов большого объема,с наличием в строках символа с кодом 0 |
|[OLAP \*\*](http://code.google.com/p/enterprise-integrator/downloads/detail?name=OLAP1_01.ocx&can=2&q=#makechanges)| OLAP1\_01.ocx автор Андрей                                                                                                         | построение OLAP кубов|
|[GameWithFire\*\*](http://www.dev.citykirov.ru/)| GameWithFire.dll автор Дмитрий Ощепков aka DmitrO                                                                                  | Внешняя компонента. Многократно увеличивает скорость работы обработки при выгрузке результатов запроса SQL в таблицу.|
|[Класс "Поле текстового документа с контекстной подсказкой"](http://infostart.ru/projects/848/)|  **ContHelp\_8**.epf автор  TormozIT                                                                                               |Быстрый выбора слова исходя из вычисляемого контекста. Поддерживается режим внутреннего языка и режим языка запросов. Принцип работы основан на безопасном вычислении типа и сборе статистики обращения к свойствам и методам объекта.Используется в формах  "Конструктор запросов" и "Произвольный алгоритм"|

|[Декодирование модуля, вер. 1.6.7 \*  \*\*](http://decompiler1c.narod.ru/) |Decode.epf  автор неизвестен | Предназначено для декомпилирования модуля объекта конфигурации. Данная компонента включена в разработку только для демонстрации уязвимости установки пароля модуля обработки. Авторы Enterprise Integrator запрешают использовать данную компоненту для получения доступа к модулю коммерческого продукта стороннего производителя и напоминают об ответсвенности за использование этой компоненты в выше перечисленном случае. |
|:--------------------------------------------------------------------------|:----------------------------|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|

Идея использования трассировки впервые была опубликована Никифоровом Вадимом aka Aeroplan в работе StrBaseSQL.epf.

Реализация разбора "сложеного" запроса на вложенные запросы была  впервые реализована Евгением Люлюк  в  работе ["Консолька 1.2"](http://www.forum.mista.ru/topic.php?id=285283).